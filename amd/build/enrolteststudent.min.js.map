{"version":3,"file":"enrolteststudent.min.js","sources":["../src/enrolteststudent.js"],"sourcesContent":["import * as Repository from 'theme_urcourses/repository';\nimport $ from 'jquery';\nimport Notification from 'core/notification';\nimport Modal from 'core/modal';\nimport ModalSaveCancel from 'core/modal_save_cancel';\nimport ModalEvents from 'core/modal_events';\nimport {get_string as getString} from 'core/str';\n\n\nconst SELECTORS = {\n    ENROL: '[data-key=\"enrol_test_student\"] a',\n    ENROL_LIST: '[data-key=\"enrol_test_student\"',\n    UNENROL: '[data-key=\"unenrol_test_student\"] a',\n    UNENROL_LIST: '[data-key=\"unenrol_test_student\"]',\n    MOREMENU: '[data-region=\"moredropdown\"]'\n};\n\nexport const init = async (courseid) => {\n    registerEventListeners(courseid);\n};\n\nconst registerEventListeners = (courseid) => {\n    $(SELECTORS.MOREMENU).on('click', SELECTORS.ENROL, e => {\n        e.preventDefault();\n        confirmEnrolTestStudent(courseid);\n    });\n\n    $(SELECTORS.MOREMENU).on('click', SELECTORS.UNENROL, e => {\n        e.preventDefault();\n        confirmUnenrolTestStudent(courseid);\n    });\n};\n\nconst confirmEnrolTestStudent = async (courseid) => {\n    const modal = await ModalSaveCancel.create({\n        title: getString('teststudentenrol_title', 'theme_urcourses'),\n        body: getString('teststudentenrol_body', 'theme_urcourses'),\n        removeOnClose: true,\n        show: true,\n        buttons: {\n            save: getString('teststudentenrol_button', 'theme_urcourses')\n        }\n    });\n    modal.getRoot().on(ModalEvents.save, () => {\n        enrolTestStudent(courseid);\n    });\n};\n\nconst enrolTestStudent = async (courseid) => {\n    try {\n        const response = await Repository.enrolTestStudent(courseid);\n        if (response) {\n            Modal.create({\n                title: getString('teststudentenrolled_title', 'theme_urcourses'),\n                body: getString('teststudentenrolled_body', 'theme_urcourses'),\n                removeOnClose: true,\n                show: true\n            });\n            $(SELECTORS.ENROL).text(await getString('unenrolurstudent', 'theme_urcourses'));\n            $(SELECTORS.ENROL_LIST).attr('data-key', 'unenrol_test_student');\n        }\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\nconst confirmUnenrolTestStudent = async (courseid) => {\n    const modal = await ModalSaveCancel.create({\n        title: getString('teststudentunenrol_title', 'theme_urcourses'),\n        body: getString('teststudentunenrol_body', 'theme_urcourses'),\n        removeOnClose: true,\n        show: true,\n        buttons: {\n            save: getString('teststudentunenrol_button', 'theme_urcourses')\n        }\n    });\n    modal.getRoot().on(ModalEvents.save, () => {\n        unenrolTestStudent(courseid);\n    });\n};\n\nconst unenrolTestStudent = async (courseid) => {\n    try {\n        const response = await Repository.unenrolTestStudent(courseid);\n        if (response) {\n            Modal.create({\n                title: getString('teststudentunenrolled_title', 'theme_urcourses'),\n                body: getString('teststudentunenrolled_body', 'theme_urcourses'),\n                removeOnClose: true,\n                show: true\n            });\n            $(SELECTORS.UNENROL).text(await getString('enrolurstudent', 'theme_urcourses'));\n            $(SELECTORS.UNENROL_LIST).attr('data-key', 'enrol_test_student');\n        }\n    } catch (error) {\n        Notification.exception(error);\n    }\n};"],"names":["SELECTORS","async","registerEventListeners","courseid","on","e","preventDefault","confirmEnrolTestStudent","confirmUnenrolTestStudent","ModalSaveCancel","create","title","body","removeOnClose","show","buttons","save","getRoot","ModalEvents","enrolTestStudent","Repository","text","attr","error","exception","unenrolTestStudent"],"mappings":"umDASMA,gBACK,oCADLA,qBAEU,iCAFVA,kBAGO,sCAHPA,uBAIY,oCAJZA,mBAKQ,6CAGMC,MAAAA,WAChBC,uBAAuBC,iBAGrBD,uBAA0BC,+BAC1BH,oBAAoBI,GAAG,QAASJ,iBAAiBK,IAC/CA,EAAEC,iBACFC,wBAAwBJ,iCAG1BH,oBAAoBI,GAAG,QAASJ,mBAAmBK,IACjDA,EAAEC,iBACFE,0BAA0BL,cAI5BI,wBAA0BN,MAAAA,kBACRQ,2BAAgBC,OAAO,CACvCC,OAAO,mBAAU,yBAA0B,mBAC3CC,MAAM,mBAAU,wBAAyB,mBACzCC,eAAe,EACfC,MAAM,EACNC,QAAS,CACLC,MAAM,mBAAU,0BAA2B,uBAG7CC,UAAUb,GAAGc,sBAAYF,MAAM,KACjCG,iBAAiBhB,cAInBgB,iBAAmBlB,MAAAA,qBAEMmB,WAAWD,iBAAiBhB,2BAEzCO,OAAO,CACTC,OAAO,mBAAU,4BAA6B,mBAC9CC,MAAM,mBAAU,2BAA4B,mBAC5CC,eAAe,EACfC,MAAM,wBAERd,iBAAiBqB,WAAW,mBAAU,mBAAoB,wCAC1DrB,sBAAsBsB,KAAK,WAAY,yBAE/C,MAAOC,6BACQC,UAAUD,SAIzBf,0BAA4BP,MAAAA,kBACVQ,2BAAgBC,OAAO,CACvCC,OAAO,mBAAU,2BAA4B,mBAC7CC,MAAM,mBAAU,0BAA2B,mBAC3CC,eAAe,EACfC,MAAM,EACNC,QAAS,CACLC,MAAM,mBAAU,4BAA6B,uBAG/CC,UAAUb,GAAGc,sBAAYF,MAAM,KACjCS,mBAAmBtB,cAIrBsB,mBAAqBxB,MAAAA,qBAEImB,WAAWK,mBAAmBtB,2BAE3CO,OAAO,CACTC,OAAO,mBAAU,8BAA+B,mBAChDC,MAAM,mBAAU,6BAA8B,mBAC9CC,eAAe,EACfC,MAAM,wBAERd,mBAAmBqB,WAAW,mBAAU,iBAAkB,wCAC1DrB,wBAAwBsB,KAAK,WAAY,uBAEjD,MAAOC,6BACQC,UAAUD"}